{"version":3,"file":"index.js","sources":["../src/api/tastyTreatsApi.js","../src/js/recipes-categories.js","../src/js/popular-recipes.js","../src/js/recipes-filter.js","../src/utils/localFavorites.js","../src/js/recipes.js"],"sourcesContent":["const BASE_URL = 'https://tasty-treats-backend.p.goit.global/api';\n\n//  Etkinlikler\nexport async function fetchEvents() {\n  const res = await fetch(`${BASE_URL}/events`);\n  return await res.json();\n}\n\n//  Tüm kategorileri getir\nexport async function fetchCategories() {\n  const res = await fetch(`${BASE_URL}/categories`);\n  return await res.json();\n}\n\n//  Filtreli tarifleri getir (opsiyonel parametreler)\nexport async function fetchFilteredRecipes({\n  category = '',\n  page = 1,\n  limit = 6,\n  time = '',\n  area = '',\n  ingredient = '',\n} = {}) {\n  const url = new URL(`${BASE_URL}/recipes`);\n  if (category) url.searchParams.append('category', category);\n  if (page) url.searchParams.append('page', page);\n  if (limit) url.searchParams.append('limit', limit);\n  if (time) url.searchParams.append('time', time);\n  if (area) url.searchParams.append('area', area);\n  if (ingredient) url.searchParams.append('ingredient', ingredient);\n\n  const res = await fetch(url);\n  return await res.json();\n}\n\n//  Popüler tarifleri getir\nexport async function fetchPopularRecipes() {\n  const res = await fetch(`${BASE_URL}/recipes/popular`);\n  return await res.json();\n}\n\n//  Belirli tarifin detayını getir\nexport async function fetchRecipeDetails(recipeId) {\n  const res = await fetch(`${BASE_URL}/recipes/${recipeId}`);\n  return await res.json();\n}\n\n//  Belirli tarife puan ver\nexport async function rateRecipe(recipeId, rating) {\n  const res = await fetch(`${BASE_URL}/recipes/${recipeId}/rating`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ rating }),\n  });\n  return await res.json();\n}\n\n//  Tüm malzemeleri getir\nexport async function fetchIngredients() {\n  const res = await fetch(`${BASE_URL}/ingredients`);\n  return await res.json();\n}\n\n//  Tüm bölgeleri getir\nexport async function fetchAreas() {\n  const res = await fetch(`${BASE_URL}/areas`);\n  return await res.json();\n}\n\n//  Sipariş oluştur\nexport async function createOrder(orderData) {\n  const res = await fetch(`${BASE_URL}/orders`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(orderData),\n  });\n  return await res.json();\n}\n","import { fetchFilteredRecipes, fetchCategories } from '../api/tastyTreatsApi.js';\n\n// --- FAVORİ YÖNETİMİ ---\nconst FAVORITES_KEY = 'favoriteRecipes';\n\nfunction getFavorites() {\n  const favorites = localStorage.getItem(FAVORITES_KEY);\n  return favorites ? JSON.parse(favorites) : [];\n}\n\nfunction addFavorite(recipe) {\n  const favorites = getFavorites();\n  if (!favorites.some(fav => fav._id === recipe._id)) {\n    favorites.push(recipe);\n    localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n  }\n}\n\nfunction removeFavorite(recipeId) {\n  let favorites = getFavorites();\n  favorites = favorites.filter(recipe => recipe._id !== recipeId);\n  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n}\n\nfunction isFavorite(recipeId) {\n  const favorites = getFavorites();\n  return favorites.some(recipe => recipe._id === recipeId);\n}\n\nfunction toggleFavorite(recipe) {\n  if (isFavorite(recipe._id)) {\n    removeFavorite(recipe._id);\n  } else {\n    addFavorite(recipe);\n  }\n}\n\n// --- DOM ELEMENTLERİ ---\nconst recipesContainer = document.querySelector('#recipes-container');\nconst paginationContainer = document.querySelector('#pagination');\nconst categoryList = document.querySelector('#category-list');\nconst allCategoriesBtn = document.querySelector('.categories-box');\n\nlet categoryRecipes = [];\nlet currentPage = 1;\nlet totalPages = 1;\nlet selectedCategory = null;\nlet limit = calculateLimit();\n\n// --- KART MARKUP ---\nfunction createRecipeCardMarkup(recipe) {\n  const ratingValue = (recipe.rating / 5) * 100;\n  const isActive = isFavorite(recipe._id) ? 'active' : '';\n  return `\n    <div class=\"recipe-card\" data-id=\"${recipe._id}\">\n      <button class=\"heart-btn ${isActive}\" aria-label=\"Favorite status\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"></path>\n        </svg>\n      </button>\n      <img class=\"recipe-card-image\" src=\"${recipe.thumb || recipe.preview}\" alt=\"${recipe.title}\" loading=\"lazy\">\n      <div class=\"recipe-card-details\">\n        <h3 class=\"recipe-card-title\">${recipe.title}</h3>\n        <p class=\"recipe-card-description\">${recipe.description}</p>\n        <div class=\"recipe-card-footer\">\n          <div class=\"recipe-card-rating\">\n            <span class=\"rating-value\">${recipe.rating.toFixed(1)}</span>\n            <div class=\"rating-stars\" style=\"--rating: ${ratingValue}%\">\n              <span>★★★★★</span><span class=\"stars-filled\">★★★★★</span>\n            </div>\n          </div>\n          <button class=\"recipe-card-button\" type=\"button\">See recipe</button>\n        </div>\n      </div>\n    </div>`;\n}\n\n// --- KARTLARI RENDER ---\nfunction rerenderAllCards(recipes, container) {\n  if (!recipes || recipes.length === 0) {\n    container.innerHTML = '<p>No recipes found to display.</p>';\n    return;\n  }\n\n  const markup = recipes.map(createRecipeCardMarkup).join('');\n  container.innerHTML = `<div class=\"recipes-list\">${markup}</div>`;\n\n  container.querySelectorAll('.heart-btn').forEach(btn => {\n    btn.addEventListener('click', () => {\n      const card = btn.closest('.recipe-card');\n      const recipeId = card.dataset.id;\n      const recipe = recipes.find(r => r._id === recipeId);\n      if (!recipe) return;\n      toggleFavorite(recipe);\n      btn.classList.toggle('active');\n      recipe.isFavorite = isFavorite(recipeId);\n    });\n  });\n\n  container.querySelectorAll('.recipe-card-button').forEach(btn => {\n    btn.addEventListener('click', () => {\n      const card = btn.closest('.recipe-card');\n      const recipeId = card.dataset.id;\n      console.log(`Open recipe details for: ${recipeId}`);\n    });\n  });\n}\n\n// --- PAGINATION ---\nconst PAGINATION_ICONS = { first: '<<', prev: '<', next: '>', last: '>>' };\n\nfunction renderPagination(totalPages, currentPage) {\n  if (!paginationContainer) return;\n  paginationContainer.innerHTML = '';\n  if (totalPages <= 1) return;\n\n  const fragment = document.createDocumentFragment();\n  const createBtn = (content, className, disabled = false) => {\n    const btn = document.createElement('button');\n    btn.innerHTML = content;\n    btn.className = className;\n    if (disabled) btn.disabled = true;\n    return btn;\n  };\n\n  // << ve < butonları\n  fragment.appendChild(createBtn(PAGINATION_ICONS.first, 'pagination-btn first', currentPage === 1));\n  fragment.appendChild(createBtn(PAGINATION_ICONS.prev, 'pagination-btn prev', currentPage === 1));\n\n  // Sayfa numaraları\n  const pagesToShow = new Set([1, totalPages, currentPage]);\n  if (currentPage > 1) pagesToShow.add(currentPage - 1);\n  if (currentPage < totalPages) pagesToShow.add(currentPage + 1);\n\n  const sortedPages = Array.from(pagesToShow).filter(n => n > 0 && n <= totalPages).sort((a, b) => a - b);\n  let lastPage = 0;\n  for (const pageNum of sortedPages) {\n    if (lastPage && pageNum > lastPage + 1) {\n      const ellipsis = document.createElement('span');\n      ellipsis.textContent = '...';\n      ellipsis.className = 'pagination-ellipsis';\n      fragment.appendChild(ellipsis);\n    }\n\n    const btn = createBtn(pageNum, 'pagination-btn number');\n    if (pageNum === currentPage) btn.classList.add('active');\n    fragment.appendChild(btn);\n    lastPage = pageNum;\n  }\n\n  // > ve >> butonları\n  fragment.appendChild(createBtn(PAGINATION_ICONS.next, 'pagination-btn next', currentPage === totalPages));\n  fragment.appendChild(createBtn(PAGINATION_ICONS.last, 'pagination-btn last', currentPage === totalPages));\n\n  paginationContainer.appendChild(fragment);\n}\n\n// --- LOAD KATEGORİ VE TARİFLER ---\nasync function loadAndDisplayCategoryRecipes(page = 1) {\n  try {\n    limit = calculateLimit();\n\n    const allCategoryRecipes = selectedCategory\n      ? await fetchFilteredRecipes({ category: selectedCategory, page: 1, limit: 1000 })\n      : await fetchFilteredRecipes({ page: 1, limit: 1000 });\n\n    const totalRecipesCount = allCategoryRecipes.totalResults || allCategoryRecipes.results.length;\n\n    const response = selectedCategory\n      ? await fetchFilteredRecipes({ page, limit, category: selectedCategory })\n      : await fetchFilteredRecipes({ page, limit });\n\n    totalPages = Math.ceil(totalRecipesCount / limit);\n    currentPage = page > totalPages ? totalPages : page;\n\n    categoryRecipes = (response.results || []).map(recipe => ({ ...recipe, isFavorite: isFavorite(recipe._id) }));\n\n    rerenderAllCards(categoryRecipes, recipesContainer);\n    renderPagination(totalPages, currentPage);\n  } catch (error) {\n    console.error('Error loading recipes:', error);\n    recipesContainer.innerHTML = '<p>Recipes could not be loaded.</p>';\n    paginationContainer.innerHTML = '';\n  }\n}\n\n// --- Kategorileri yükle ---\nasync function loadCategories() {\n  try {\n    const categories = await fetchCategories();\n    categoryList.innerHTML = categories.map(cat => `\n      <li><button class=\"category-btn ${cat.name === selectedCategory ? 'active' : ''}\" data-category=\"${cat.name}\">${cat.name}</button></li>\n    `).join('');\n  } catch (error) {\n    console.error('Failed to load categories:', error);\n  }\n}\n\n// --- Event listeners ---\ncategoryList.addEventListener('click', e => {\n  const btn = e.target.closest('.category-btn');\n  if (!btn) return;\n  selectedCategory = btn.dataset.category;\n  currentPage = 1;\n  categoryList.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));\n  if (allCategoriesBtn) allCategoriesBtn.classList.remove('active');\n  btn.classList.add('active');\n  loadAndDisplayCategoryRecipes(currentPage);\n});\n\nif (allCategoriesBtn) {\n  allCategoriesBtn.addEventListener('click', () => {\n    selectedCategory = null;\n    currentPage = 1;\n    allCategoriesBtn.classList.add('active');\n    categoryList.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));\n    loadAndDisplayCategoryRecipes(currentPage);\n  });\n}\n\n// --- PAGINATION CLICK ---\npaginationContainer.addEventListener('click', e => {\n  const btn = e.target.closest('button');\n  if (!btn) return;\n  let page = currentPage;\n\n  switch (true) {\n    case btn.classList.contains('first'): page = 1; break;\n    case btn.classList.contains('prev'): page = currentPage - 1; break;\n    case btn.classList.contains('next'): page = currentPage + 1; break;\n    case btn.classList.contains('last'): page = totalPages; break;\n    case btn.classList.contains('number'): page = Number(btn.textContent); break;\n  }\n\n  if (page >= 1 && page <= totalPages) {\n    currentPage = page;\n    loadAndDisplayCategoryRecipes(currentPage);\n  }\n});\n\n// --- Resize ---\nwindow.addEventListener('resize', debounce(() => {\n  const newLimit = calculateLimit();\n  if (newLimit !== limit) {\n    currentPage = 1;\n    loadAndDisplayCategoryRecipes(currentPage);\n  }\n}));\n\n// --- Başlangıç ---\nloadCategories();\nloadAndDisplayCategoryRecipes();\n\n// --- Yardımcı fonksiyonlar ---\nfunction debounce(func, delay = 250) {\n  let timeoutId;\n  return function (...args) {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => func.apply(this, args), delay);\n  };\n}\n\nfunction calculateLimit() {\n  const width = window.innerWidth;\n  if (width < 768) return 6;\n  if (width < 1280) return 8;\n  return 9;\n}\n","import { fetchPopularRecipes } from '../api/tastyTreatsApi.js';\n\nconst popularRecipeContainer = document.querySelector(\n  '.popular-recipe-wrapper'\n);\n\nconsole.log(fetchPopularRecipes());\n\nasync function displayPopularRecipes() {\n  try {\n    popularRecipeContainer.innerHTML = `<p>Loading recipes...</p>`;\n\n    const recipes = await fetchPopularRecipes();\n\n    if (!recipes || recipes.length === 0) {\n      popularRecipeContainer.innerHTML = `<p>No popular recipes found!</p>`;\n      return;\n    }\n    const markup = recipes\n      .map(recipe => {\n        return `\n    <div class=\"popular-recipes-card\" data-id=\"${recipe._id}\">\n    <img class=\"popular-recipes-image\" src=\"${recipe.preview}\" alt=\"${recipe.title}\" />\n    <div class=\"popular-recipes-info\">\n    <h3 class=\"popular-recipes-title recipe-title\">${recipe.title}</h3>\n      <p class=\"popular-recipes-description popular-recipe-text \">${recipe.description}</p>\n      </div>\n    </div>\n  `;\n      })\n      .join('');\n\n    popularRecipeContainer.innerHTML = markup;\n  } catch (error) {\n    console.error('Failed to fetch popular recipes:', error);\n    popularRecipeContainer.innerHTML = `<p>Sorry, we could not load the recipes at this time</p>`;\n  }\n}\ndisplayPopularRecipes();\n","// recipes-filter.js\n// --- API'yi direkt import et ---\nimport {\n  fetchFilteredRecipes,\n  fetchAreas,\n  fetchIngredients,\n} from '../api/tastyTreatsApi.js';\n\n// ---- Elementler\nconst root = document.querySelector('.filters');\nif (!root) console.warn('[filters] .filters bulunamadı.');\n\n// Filtre modunun pagination'ı (HTML'de <div id=\"pagination-filters\">)\nconst paginationContainer =\n  document.getElementById('pagination-filters') ||\n  document.getElementById('pagination'); // son çare, ama asıl hedef -filters\n\nconst el = {\n  search: root?.querySelector('.filter-input'),\n  searchBtn: root?.querySelector('.search-btn'),\n  resetBtn: root?.querySelector('.reset-filter'),\n  dropdowns: [...(root?.querySelectorAll('.custom-dropdown') ?? [])],\n  recipes: document.getElementById('recipes-flex'), // bizim grid\n};\n\n// Kategoriler modunun alanları (native)\nconst native = {\n  grid: document.getElementById('recipes-container'),\n  pagination: document.getElementById('pagination'),\n};\n\nconst USE_LOCAL_RENDER = !!el.recipes;\n\n// ---- Durum\nconst state = {\n  query: '',\n  time: '', // \"40\"\n  area: '', // \"Italian\"\n  ingredient: '', // _id\n  ingredientLabel: '',\n  page: 1,\n  limit: 6, // API limiti; ekranda görünen kart sayısını ayrıca sınırlıyoruz\n  loading: false,\n\n  // responsive render için\n  lastItems: [],\n  favs: new Set(),\n};\n\n// --- Favorites (localStorage)\nconst FAV_KEY = 'tt:favorites';\n\nconst readFavs = () => {\n  try {\n    return new Set(JSON.parse(localStorage.getItem(FAV_KEY) || '[]'));\n  } catch {\n    return new Set();\n  }\n};\nconst writeFavs = set => {\n  localStorage.setItem(FAV_KEY, JSON.stringify([...set]));\n};\nconst isFavorite = id => state.favs.has(id);\n\n// toggle -> true: eklendi, false: çıkarıldı, null: id yok\nconst toggleFavorite = id => {\n  if (!id) return null;\n  const wasFav = state.favs.has(id);\n  if (wasFav) state.favs.delete(id);\n  else state.favs.add(id);\n  writeFavs(state.favs);\n  return !wasFav;\n};\n\nstate.favs = readFavs();\n\n/* ---------- FAVORI SENKRON + TEMIZLE ---------- */\n// storage'taki saçma id'leri temizle (\"\" / \"null\" / \"undefined\")\nfunction sanitizeFavorites() {\n  const cleaned = [...state.favs].filter(\n    id => id && id !== 'null' && id !== 'undefined'\n  );\n  if (cleaned.length !== state.favs.size) {\n    state.favs = new Set(cleaned);\n    writeFavs(state.favs);\n  }\n}\n// Sayfadaki kalpleri storage'a göre hizala\nfunction syncHeartsWithFavorites(scope = document) {\n  const hearts = scope.querySelectorAll('.heart-btn');\n  hearts.forEach(btn => {\n    const id = btn.closest('[data-id]')?.dataset.id?.trim();\n    const shouldBeActive = !!id && isFavorite(id);\n    btn.classList.toggle('active', shouldBeActive);\n  });\n}\nsanitizeFavorites();\n\nconst timeOptions = ['10 min', '20 min', '30 min', '40 min'];\n\n/* ---------- Yardımcılar ---------- */\nfunction setLoading(isLoading) {\n  state.loading = isLoading;\n  if (!USE_LOCAL_RENDER || !el.recipes) return;\n  if (isLoading)\n    el.recipes.innerHTML = `<div class=\"recipes-loading\">Loading...</div>`;\n}\n\nconst FETCH_TIMEOUT_MS = 10000;\nconst withTimeout = (p, ms = FETCH_TIMEOUT_MS) =>\n  Promise.race([\n    p,\n    new Promise((_, r) =>\n      setTimeout(() => r(new Error('REQUEST_TIMEOUT')), ms)\n    ),\n  ]);\n\nfunction parseTimeLabelToMinutes(label) {\n  const m = String(label).match(/\\d+/);\n  return m ? m[0] : '';\n}\nfunction closeAllMenus(except) {\n  el.dropdowns.forEach(dd => {\n    if (dd !== except) dd.classList.remove('open');\n  });\n}\nfunction escapeHtml(s) {\n  return String(s)\n    .replaceAll('&', '&amp;')\n    .replaceAll('<', '&lt;')\n    .replaceAll('>', '&gt;')\n    .replaceAll('\"', '&quot;')\n    .replaceAll(\"'\", '&#39;');\n}\n\n// Ekrana göre kart limiti (D:9 / T:8 / M:6)\nfunction getCardLimitByViewport() {\n  const w = window.innerWidth || 1200;\n  if (w >= 1024) return 9; // Desktop: 3x3\n  if (w >= 768) return 8; // Tablet: 2x4\n  return 6; // Mobile\n}\n\n// Filtre aktif mi? (arama veya herhangi bir dropdown seçiliyse)\nfunction isFiltersActive() {\n  return !!(state.query || state.time || state.area || state.ingredient);\n}\nfunction showFiltersMode() {\n  if (native.grid) native.grid.style.display = 'none';\n  if (native.pagination) native.pagination.style.display = 'none';\n  if (el.recipes) el.recipes.style.display = ''; // bizim grid görünür\n  if (paginationContainer) paginationContainer.style.display = ''; // bizim pagination görünür\n  document.dispatchEvent(new CustomEvent('filters:activate'));\n}\nfunction showNativeMode() {\n  if (el.recipes) el.recipes.style.display = 'none';\n  if (paginationContainer) paginationContainer.style.display = 'none';\n  if (native.grid) native.grid.style.display = '';\n  if (native.pagination) native.pagination.style.display = '';\n  document.dispatchEvent(new CustomEvent('filters:deactivate'));\n}\n\n/* ---------- Rendererlar ---------- */\nfunction renderPagination(totalPages, currentPage) {\n  if (!paginationContainer) return;\n\n  totalPages = Math.max(1, Number(totalPages) || 1);\n  currentPage = Math.min(totalPages, Math.max(1, Number(currentPage) || 1));\n\n  const pagesToShow = 1;\n  const arrowClassesPrev = 'pagination-btn arrow-btn arrow-prev';\n  const arrowClassesNext = 'pagination-btn arrow-btn arrow-next';\n\n  let markup = `\n    <button class=\"${arrowClassesPrev}\" data-page=\"1\" ${\n    currentPage === 1 ? 'disabled' : ''\n  }>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"11 17 6 12 11 7\"></polyline><polyline points=\"18 17 13 12 18 7\"></polyline></svg>\n    </button>\n    <button class=\"${arrowClassesPrev}\" data-page=\"${currentPage - 1}\" ${\n    currentPage === 1 ? 'disabled' : ''\n  }>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"15 18 9 12 15 6\"></polyline></svg>\n    </button>\n  `;\n\n  if (totalPages > 1) {\n    if (currentPage > pagesToShow + 2) {\n      markup += `<button class=\"pagination-btn page-btn\" data-page=\"1\">1</button>`;\n      markup += `<button class=\"pagination-btn dots\" disabled>...</button>`;\n    }\n\n    for (\n      let i = Math.max(1, currentPage - pagesToShow);\n      i <= Math.min(totalPages, currentPage + pagesToShow);\n      i++\n    ) {\n      if (i === 1 && currentPage > pagesToShow + 2) continue;\n      if (i === totalPages && currentPage < totalPages - pagesToShow - 1)\n        continue;\n\n      markup += `<button class=\"pagination-btn page-btn ${\n        i === currentPage ? 'active' : ''\n      }\" data-page=\"${i}\">${i}</button>`;\n    }\n\n    if (currentPage < totalPages - pagesToShow - 1) {\n      markup += `<button class=\"pagination-btn dots\" disabled>...</button>`;\n      markup += `<button class=\"pagination-btn page-btn\" data-page=\"${totalPages}\">${totalPages}</button>`;\n    }\n  }\n\n  markup += `\n    <button class=\"${arrowClassesNext}\" data-page=\"${currentPage + 1}\" ${\n    currentPage === totalPages ? 'disabled' : ''\n  }>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"9 18 15 12 9 6\"></polyline></svg>\n    </button>\n    <button class=\"${arrowClassesNext}\" data-page=\"${totalPages}\" ${\n    currentPage === totalPages ? 'disabled' : ''\n  }>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"13 17 18 12 13 7\"></polyline><polyline points=\"6 17 11 12 6 7\"></polyline></svg>\n    </button>\n  `;\n\n  paginationContainer.innerHTML = totalPages <= 1 ? '' : markup;\n}\n\nfunction renderRecipes(items) {\n  if (!el.recipes) return;\n\n  const limitByViewport = getCardLimitByViewport();\n  const list = Array.isArray(items) ? items.slice(0, limitByViewport) : [];\n\n  if (!list.length) {\n    el.recipes.innerHTML = '';\n    return;\n  }\n\n  const html = list\n    .map(rec => {\n      const {\n        _id,\n        title = 'Untitled',\n        description = '',\n        rating = 0,\n        preview,\n        thumb,\n      } = rec;\n\n      const img = preview || thumb || '';\n      const safeTitle = escapeHtml(title);\n      const safeDesc = escapeHtml(description);\n      const ratingNum = Number(rating) || 0;\n      const ratingPct = Math.max(0, Math.min(100, (ratingNum / 5) * 100));\n      const activeClass = isFavorite(_id) ? 'active' : '';\n\n      return `\n      <div class=\"recipe-card\" data-id=\"${_id || ''}\">\n        <button class=\"heart-btn ${activeClass}\" aria-label=\"Add to favorites\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\"\n               viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\"\n               stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"></path>\n          </svg>\n        </button>\n\n        ${\n          img\n            ? `<img class=\"recipe-card-image\" src=\"${img}\" alt=\"${safeTitle}\" loading=\"lazy\">`\n            : ''\n        }\n\n        <div class=\"recipe-card-details\">\n          <h3 class=\"recipe-card-title\">${safeTitle}</h3>\n          ${\n            safeDesc ? `<p class=\"recipe-card-description\">${safeDesc}</p>` : ''\n          }\n\n          <div class=\"recipe-card-footer\">\n            <div class=\"recipe-card-rating\">\n              <span class=\"rating-value\">${ratingNum.toFixed(1)}</span>\n              <div class=\"rating-stars\" style=\"--rating:${ratingPct}%\">\n                <span>★★★★★</span>\n                <span class=\"stars-filled\">★★★★★</span>\n              </div>\n            </div>\n            <button class=\"recipe-card-button\" type=\"button\">See recipe</button>\n          </div>\n        </div>\n      </div>`;\n    })\n    .join('');\n\n  el.recipes.innerHTML = html;\n\n  // Yeni basılan kartları storage'a göre hizala\n  syncHeartsWithFavorites(el.recipes);\n}\n\n/* ---------- FETCH + RENDER (önce tanımlı!) ---------- */\nasync function applyFilters() {\n  try {\n    if (!isFiltersActive()) {\n      showNativeMode();\n      return;\n    }\n\n    showFiltersMode();\n    setLoading(true);\n\n    // ---- Dinamik limit ----\n    const pageSize = getCardLimitByViewport();\n    state.limit = pageSize; // state’i güncel tut\n    const { time, area, ingredient, page } = state;\n\n    const data = await withTimeout(\n      fetchFilteredRecipes({ time, area, ingredient, page, limit: pageSize })\n    );\n\n    const list = Array.isArray(data?.results)\n      ? data.results\n      : Array.isArray(data)\n      ? data\n      : Array.isArray(data?.recipes)\n      ? data.recipes\n      : [];\n\n    const q = state.query.toLowerCase();\n    const filtered = q\n      ? list.filter(r =>\n          String(r.title || '')\n            .toLowerCase()\n            .includes(q)\n        )\n      : list;\n\n    state.lastItems = filtered;\n\n    if (USE_LOCAL_RENDER) {\n      renderRecipes(filtered.slice(0, pageSize));\n\n      // ---- Pagination hesapları ----\n      if (paginationContainer) {\n        const apiTotalPages =\n          Number(data?.totalPages) || Number(data?.pageCount) || 0;\n\n        const totalItems =\n          Number(data?.total) ||\n          Number(data?.count) ||\n          Number(data?.resultsCount) ||\n          Number(data?.hits) ||\n          (Array.isArray(data?.results) ? data.results.length : 0);\n\n        const totalPages =\n          apiTotalPages ||\n          Math.max(1, Math.ceil((totalItems || filtered.length) / pageSize));\n\n        renderPagination(totalPages, state.page);\n      }\n\n      if (!filtered.length && el.recipes)\n        el.recipes.innerHTML = '<p class=\"no-results\">No recipes found</p>';\n    }\n\n    document.dispatchEvent(\n      new CustomEvent('recipes:filtered', {\n        detail: {\n          recipes: filtered,\n          paging: { page, limit: pageSize },\n          raw: data,\n        },\n      })\n    );\n  } catch (err) {\n    console.error('[filters] applyFilters error:', err?.message || err);\n    if (USE_LOCAL_RENDER && el.recipes) {\n      el.recipes.innerHTML =\n        err?.message === 'REQUEST_TIMEOUT'\n          ? `<p class=\"no-results\">İstek zaman aşımına uğradı. Lütfen tekrar deneyin.</p>`\n          : `<p class=\"no-results\">Bir şeyler ters gitti. Lütfen tekrar deneyin.</p>`;\n    }\n    document.dispatchEvent(\n      new CustomEvent('recipes:filtered', {\n        detail: {\n          recipes: [],\n          error: true,\n          reason: err?.message || String(err),\n        },\n      })\n    );\n  } finally {\n    setLoading(false);\n  }\n}\n\n/* ---------- Dropdownlar ---------- */\nasync function initDropdowns() {\n  // Time (statik)\n  populateDropdown(\n    'time',\n    timeOptions.map(t => ({ value: parseTimeLabelToMinutes(t), label: t }))\n  );\n\n  // Area (isimle)\n  try {\n    const areas = await fetchAreas();\n    const list = (Array.isArray(areas) ? areas : [])\n      .map(a => (typeof a === 'string' ? a : a?.name))\n      .filter(Boolean)\n      .map(name => ({ value: name, label: name }));\n    populateDropdown('area', list);\n  } catch (e) {\n    console.error('Areas yüklenemedi', e);\n    populateDropdown('area', []);\n  }\n\n  // Ingredient (_id gönder, label name)\n  try {\n    const ingredients = await fetchIngredients();\n    const list = (Array.isArray(ingredients) ? ingredients : [])\n      .filter(i => i?._id && i?.name)\n      .map(i => ({ value: i._id, label: i.name }));\n    populateDropdown('ingredient', list);\n  } catch (e) {\n    console.error('Ingredients yüklenemedi', e);\n    populateDropdown('ingredient', []);\n  }\n}\n\nfunction populateDropdown(type, items /* [{value,label}] */) {\n  const dd = el.dropdowns.find(d => d.dataset.type === type);\n  if (!dd) return;\n  const menu = dd.querySelector('.dropdown-menu');\n  const toggle = dd.querySelector('.dropdown-toggle');\n  if (!menu || !toggle) return;\n\n  menu.innerHTML = (items || [])\n    .map(\n      opt =>\n        `<li><button type=\"button\" data-value=\"${escapeHtml(\n          opt.value\n        )}\" data-label=\"${escapeHtml(opt.label)}\">${escapeHtml(\n          opt.label\n        )}</button></li>`\n    )\n    .join('');\n\n  // Aç/Kapat\n  toggle.addEventListener('click', () => {\n    const willOpen = !dd.classList.contains('open');\n    closeAllMenus();\n    dd.classList.toggle('open', willOpen);\n  });\n\n  // Seçim\n  menu.addEventListener('click', e => {\n    const btn = e.target.closest('button[data-value]');\n    if (!btn) return;\n    const value = btn.getAttribute('data-value') ?? '';\n    const label = btn.getAttribute('data-label') ?? btn.textContent.trim();\n\n    if (type === 'time') {\n      state.time = value;\n    } else if (type === 'area') {\n      state.area = label;\n    } else if (type === 'ingredient') {\n      state.ingredient = value;\n      state.ingredientLabel = label;\n    }\n\n    toggle.textContent = label;\n    dd.classList.remove('open');\n    state.page = 1;\n    applyFilters(); // seçimle birlikte bizim mod devreye girer\n  });\n}\n\n/* ---------- Global kapatma ---------- */\ndocument.addEventListener('click', e => {\n  const current = e.target.closest('.custom-dropdown');\n  if (!current) return closeAllMenus();\n  el.dropdowns.forEach(dd => {\n    if (dd !== current) dd.classList.remove('open');\n  });\n});\ndocument.addEventListener('keydown', e => {\n  if (e.key === 'Escape') closeAllMenus();\n});\n\n/* ---------- Search ---------- */\nfunction initSearch() {\n  if (!el.search || !el.searchBtn) return;\n  const run = () => {\n    state.query = el.search.value.trim();\n    state.page = 1;\n    applyFilters();\n  };\n  el.searchBtn.addEventListener('click', run);\n  el.search.addEventListener('keydown', e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      run();\n    }\n  });\n}\n\n// Varsayılan dropdown metinlerini sakla\nconst defaultDropdownLabels = {};\n(el.dropdowns || []).forEach(dd => {\n  const type = dd.dataset.type; // time | area | ingredient\n  const toggle = dd.querySelector('.dropdown-toggle');\n  if (type && toggle) {\n    defaultDropdownLabels[type] =\n      toggle.getAttribute('data-default') || toggle.textContent.trim();\n  }\n});\n\nfunction initReset() {\n  if (!el.resetBtn) return;\n  el.resetBtn.addEventListener('click', () => {\n    // State'i temizle\n    state.query = '';\n    state.time = '';\n    state.area = '';\n    state.ingredient = '';\n    state.ingredientLabel = '';\n    state.page = 1;\n\n    // Arama input'unu temizle\n    if (el.search) el.search.value = '';\n\n    // Dropdown metinlerini ve seçili öğeleri sıfırla\n    (el.dropdowns || []).forEach(dd => {\n      const type = dd.dataset.type;\n      const toggle = dd.querySelector('.dropdown-toggle');\n      const menu = dd.querySelector('.dropdown-menu');\n      if (toggle) {\n        toggle.textContent = defaultDropdownLabels[type] || 'Select';\n      }\n      menu\n        ?.querySelectorAll('.selected')\n        .forEach(n => n.classList.remove('selected'));\n      dd.classList.remove('open');\n    });\n\n    // Filtreyi sıfırlayıp native moda dön\n    applyFilters();\n  });\n}\n\n/* ---------- Başlat ---------- */\n(async function init() {\n  try {\n    if (el.recipes) {\n      el.recipes.classList.add('recipes-list'); // grid görünümü için\n      el.recipes.style.display = 'none'; // ilk açılışta native kalsın\n    }\n    if (paginationContainer) paginationContainer.style.display = 'none';\n\n    await initDropdowns();\n    initSearch();\n    initReset();\n    await applyFilters(); // filtre pasif => native mod\n\n    // İlk yüklemede var olan kalpleri storage'a hizala\n    syncHeartsWithFavorites();\n\n    // Pagination tıklama\n    if (paginationContainer) {\n      paginationContainer.addEventListener('click', e => {\n        const btn = e.target.closest('.pagination-btn');\n        if (!btn || btn.classList.contains('dots')) return;\n\n        const page = parseInt(btn.dataset.page, 10);\n        if (!isNaN(page) && page !== state.page) {\n          state.page = page;\n          applyFilters();\n        }\n      });\n    }\n\n    // Kalp butonu: güvenli ID ile toggle + UI senkron\n    document.addEventListener('click', e => {\n      const heart = e.target.closest('.heart-btn');\n      if (!heart) return;\n\n      // En yakın data-id taşıyan ata üzerinden id al\n      const host = heart.closest('[data-id]');\n      const id = host?.dataset.id?.trim();\n\n      if (!id) {\n        console.warn('[favorites] data-id bulunamadı; işlem yapılmadı.');\n        return;\n      }\n\n      const nowFav = toggleFavorite(id); // true: eklendi, false: çıkarıldı\n      if (nowFav === null) return;\n\n      heart.classList.toggle('active', nowFav);\n    });\n\n    // (Opsiyonel) \"Favorites\" menü linkine tıklama\n    document\n      .querySelector('.nav-link[href=\"./favorites.html\"]')\n      ?.addEventListener('click', () => {\n        console.log('Favorites link clicked, redirecting...');\n      });\n\n    // \"See recipe\" butonuna tıklama\n    document.addEventListener('click', e => {\n      const btn = e.target.closest('.recipe-card-button');\n      if (btn) {\n        const card = btn.closest('.recipe-card');\n        const id = card?.dataset.id;\n        if (id) {\n          console.log('Recipe clicked:', id);\n          // burada id ile detay sayfasına yönlendirebilirsin\n        }\n      }\n    });\n\n    // Resize'da son sonuçları kart limitine göre tekrar çiz\n    window.addEventListener('resize', () => {\n      if (!state.lastItems?.length) return;\n      renderRecipes(state.lastItems);\n    });\n  } catch (e) {\n    console.error('[filters] init error:', e);\n    if (el.recipes)\n      el.recipes.innerHTML = `<p class=\"no-results\">Bir şeyler ters gitti. Lütfen tekrar deneyin.</p>`;\n  }\n})();\n","const FAVORITES_KEY = 'favoriteRecipes';\n\nexport function getFavorites() {\n  try {\n    return JSON.parse(localStorage.getItem(FAVORITES_KEY)) || [];\n  } catch (e) {\n    return [];\n  }\n}\n\nexport function saveFavorites(favorites) {\n  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n}\n\nexport function toggleFavorite(recipe) {\n  const favorites = getFavorites();\n  const exists = favorites.some(fav => fav._id === recipe._id);\n\n  if (exists) {\n    const updated = favorites.filter(fav => fav._id !== recipe._id);\n    saveFavorites(updated);\n  } else {\n    favorites.push(recipe);\n    saveFavorites(favorites);\n  }\n}\n\nexport function isFavorite(recipeId) {\n  const favorites = getFavorites();\n  return favorites.some(fav => fav._id === recipeId);\n}\n","import { fetchFilteredRecipes } from '../api/tastyTreatsApi.js';\nimport { toggleFavorite, isFavorite } from '../utils/localFavorites.js';\n\nconst recipesContainer = document.querySelector('#recipes-container');\nconst paginationContainer = document.querySelector('#pagination');\n\nlet currentRecipes = [];\n\nlet currentPage = 1;\nlet totalPages = 1;\nlet limit = calculateLimit();\n\nfunction createRecipeCardMarkup(recipe) {\n  const ratingValue = (recipe.rating / 5) * 100;\n  const isActive = isFavorite(recipe._id) ? 'active' : '';\n  return `\n    <div class=\"recipe-card\" data-id=\"${recipe._id}\">\n      <button class=\"heart-btn ${isActive}\" aria-label=\"Add to favorites\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"22\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <path d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\"></path>\n        </svg>\n      </button>\n      <img class=\"recipe-card-image\" src=\"${recipe.thumb}\" alt=\"${\n    recipe.title\n  }\" loading=\"lazy\">\n      <div class=\"recipe-card-details\">\n        <h3 class=\"recipe-card-title\">${recipe.title}</h3>\n        <p class=\"recipe-card-description\">${recipe.description}</p>\n        <div class=\"recipe-card-footer\">\n          <div class=\"recipe-card-rating\">\n            <span class=\"rating-value\">${recipe.rating.toFixed(1)}</span>\n            <div class=\"rating-stars\" style=\"--rating: ${ratingValue}%\">\n              <span>★★★★★</span><span class=\"stars-filled\">★★★★★</span>\n            </div>\n          </div>\n          <button class=\"recipe-card-button\" type=\"button\">See recipe</button>\n        </div>\n      </div>\n    </div>`;\n}\n\nfunction rerenderAllCards() {\n  if (!currentRecipes || currentRecipes.length === 0) return;\n  const recipesMarkup = currentRecipes.map(createRecipeCardMarkup).join('');\n  recipesContainer.innerHTML = recipesMarkup;\n}\n\nasync function loadAndDisplayRecipes(page = 1) {\n  try {\n    limit = calculateLimit();\n    const response = await fetchFilteredRecipes({ page, limit });\n    currentRecipes = response.results;\n    totalPages =\n      response.totalPages || Math.ceil(response.totalResults / limit);\n    rerenderAllCards();\n    renderPagination(totalPages, page);\n  } catch (error) {\n    console.error('An error occurred while loading recipes:', error);\n    recipesContainer.innerHTML =\n      '<p>The recipes could not be loaded. Please try again later.</p>';\n    paginationContainer.innerHTML = '';\n  }\n}\n\nrecipesContainer.addEventListener('click', event => {\n  const heartBtn = event.target.closest('.heart-btn');\n  if (!heartBtn) return;\n\n  const recipeCard = heartBtn.closest('.recipe-card');\n  const recipeId = recipeCard.dataset.id;\n  const recipe = currentRecipes.find(r => r._id === recipeId);\n  if (!recipe) return;\n  toggleFavorite(recipe);\n  rerenderAllCards();\n});\n\npaginationContainer.addEventListener('click', event => {\n  const btn = event.target.closest('.pagination-btn');\n  if (!btn || btn.disabled || !btn.dataset.page) return;\n  const selectedPage = Number(btn.dataset.page);\n  if (selectedPage !== currentPage) {\n    currentPage = selectedPage;\n    loadAndDisplayRecipes(currentPage);\n  }\n});\n\nfunction renderPagination(totalPages, currentPage) {\n  let markup = '';\n  const pagesToShow = 1;\n  const arrowClassesPrev = 'pagination-btn arrow-btn arrow-prev';\n  const arrowClassesNext = 'pagination-btn arrow-btn arrow-next';\n  markup += `<button class=\"${arrowClassesPrev}\" data-page=\"1\" ${\n    currentPage === 1 ? 'disabled' : ''\n  }><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"11 17 6 12 11 7\"></polyline><polyline points=\"18 17 13 12 18 7\"></polyline></svg></button>`;\n  markup += `<button class=\"${arrowClassesPrev}\" data-page=\"${\n    currentPage - 1\n  }\" ${\n    currentPage === 1 ? 'disabled' : ''\n  }><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"15 18 9 12 15 6\"></polyline></svg></button>`;\n  if (totalPages > 1) {\n    if (currentPage > pagesToShow + 2) {\n      markup += `<button class=\"pagination-btn page-btn\" data-page=\"1\">1</button>`;\n      markup += `<button class=\"pagination-btn dots\">...</button>`;\n    }\n    for (\n      let i = Math.max(1, currentPage - pagesToShow);\n      i <= Math.min(totalPages, currentPage + pagesToShow);\n      i++\n    ) {\n      if (i === 1 && currentPage > pagesToShow + 2) continue;\n      if (i === totalPages && currentPage < totalPages - pagesToShow - 1)\n        continue;\n      markup += `<button class=\"pagination-btn page-btn ${\n        i === currentPage ? 'active' : ''\n      }\" data-page=\"${i}\">${i}</button>`;\n    }\n    if (currentPage < totalPages - pagesToShow - 1) {\n      markup += `<button class=\"pagination-btn dots\">...</button>`;\n      markup += `<button class=\"pagination-btn page-btn\" data-page=\"${totalPages}\">${totalPages}</button>`;\n    }\n  }\n  markup += `<button class=\"${arrowClassesNext}\" data-page=\"${\n    currentPage + 1\n  }\" ${\n    currentPage === totalPages ? 'disabled' : ''\n  }><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"9 18 15 12 9 6\"></polyline></svg></button>`;\n  markup += `<button class=\"${arrowClassesNext}\" data-page=\"${totalPages}\" ${\n    currentPage === totalPages ? 'disabled' : ''\n  }><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"13 17 18 12 13 7\"></polyline><polyline points=\"6 17 11 12 6 7\"></polyline></svg></button>`;\n  paginationContainer.innerHTML = markup;\n}\n\nconst handleResize = debounce(() => {\n  const newLimit = calculateLimit();\n  if (newLimit !== limit) {\n    currentPage = 1;\n    loadAndDisplayRecipes(currentPage);\n  }\n});\n\nwindow.addEventListener('resize', handleResize);\nloadAndDisplayRecipes();\nfunction debounce(func, delay = 250) {\n  let timeoutId;\n  return function (...args) {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => {\n      func.apply(this, args);\n    }, delay);\n  };\n}\nfunction calculateLimit() {\n  const width = window.innerWidth;\n  if (width < 768) return 6;\n  if (width < 1280) return 8;\n  return 9;\n}\n"],"names":["BASE_URL","fetchCategories","fetchFilteredRecipes","category","page","limit","time","area","ingredient","url","fetchPopularRecipes","fetchIngredients","fetchAreas","FAVORITES_KEY","getFavorites","favorites","addFavorite","recipe","fav","removeFavorite","recipeId","isFavorite","toggleFavorite","recipesContainer","paginationContainer","categoryList","allCategoriesBtn","categoryRecipes","currentPage","totalPages","selectedCategory","calculateLimit","createRecipeCardMarkup","ratingValue","isActive","rerenderAllCards","recipes","container","markup","btn","r","PAGINATION_ICONS","renderPagination","fragment","createBtn","content","className","disabled","pagesToShow","sortedPages","n","a","b","lastPage","pageNum","ellipsis","loadAndDisplayCategoryRecipes","allCategoryRecipes","totalRecipesCount","response","error","loadCategories","categories","cat","debounce","func","delay","timeoutId","args","width","popularRecipeContainer","displayPopularRecipes","root","el","native","USE_LOCAL_RENDER","state","FAV_KEY","readFavs","writeFavs","set","id","wasFav","sanitizeFavorites","cleaned","syncHeartsWithFavorites","scope","_b","_a","shouldBeActive","timeOptions","setLoading","isLoading","FETCH_TIMEOUT_MS","withTimeout","p","ms","_","parseTimeLabelToMinutes","label","m","closeAllMenus","except","dd","escapeHtml","s","getCardLimitByViewport","w","isFiltersActive","showFiltersMode","showNativeMode","arrowClassesPrev","arrowClassesNext","i","renderRecipes","items","limitByViewport","list","html","rec","_id","title","description","rating","preview","thumb","img","safeTitle","safeDesc","ratingNum","ratingPct","activeClass","applyFilters","pageSize","data","q","filtered","apiTotalPages","totalItems","err","initDropdowns","populateDropdown","t","areas","name","ingredients","type","d","menu","toggle","opt","willOpen","e","value","current","initSearch","run","defaultDropdownLabels","initReset","heart","host","nowFav","card","saveFavorites","updated","currentRecipes","recipesMarkup","loadAndDisplayRecipes","event","heartBtn","selectedPage","handleResize"],"mappings":"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"}