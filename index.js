import"./assets/styles-BIzYtEVP.js";const E="https://tasty-treats-backend.p.goit.global/api";async function oe(){return await(await fetch(`${E}/categories`)).json()}async function H({category:e="",page:t=1,limit:n=6,time:r="",area:s="",ingredient:i=""}={}){const a=new URL(`${E}/recipes`);return e&&a.searchParams.append("category",e),t&&a.searchParams.append("page",t),n&&a.searchParams.append("limit",n),r&&a.searchParams.append("time",r),s&&a.searchParams.append("area",s),i&&a.searchParams.append("ingredient",i),await(await fetch(a)).json()}async function Q(){return await(await fetch(`${E}/recipes/popular`)).json()}async function ce(){return await(await fetch(`${E}/ingredients`)).json()}async function le(){return await(await fetch(`${E}/areas`)).json()}const y=document.querySelector("#recipes-container"),x=document.querySelector("#pagination"),q=document.querySelector("#category-list"),m=document.querySelector(".categories-box");let g=1,V=1,v=null,A=N();function N(){const e=window.innerWidth;return e<768?6:e<1280?8:9}async function de(){try{const t=(await oe()).map(r=>`
        <li>
          <button 
            class="category-btn ${r.name===v?"active":""}" 
            data-category="${r.name}">
            ${r.name}
          </button>
        </li>`).join("");q.innerHTML=t;const n=q.querySelectorAll(".category-btn");n.forEach(r=>{r.addEventListener("click",()=>{const s=r.dataset.category;s!==v&&(v=s,g=1,n.forEach(i=>i.classList.remove("active")),m.classList.remove("active"),r.classList.add("active"),S(g))})})}catch(e){console.error("Failed to load categories:",e)}}m&&m.addEventListener("click",()=>{v!==null&&(v=null,g=1,q.querySelectorAll(".category-btn").forEach(t=>t.classList.remove("active")),m.classList.add("active"),S(g))});async function S(e=1){try{A=N();const t=await H({page:e,limit:A,category:v||void 0}),n=t.results;if(V=t.totalPages||Math.ceil(t.totalResults/A),!n||n.length===0){y.innerHTML="<p>No recipes found to display.</p>",x.innerHTML="";return}const r=n.map(s=>{const i=s.rating/5*100;return`
        <div class="recipe-card" data-id="${s._id}">
          <button class="heart-btn" aria-label="Add to favorites">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
          </button>
          <img class="recipe-card-image" src="${s.thumb}" alt="${s.title}" loading="lazy">
          <div class="recipe-card-details">
            <h3 class="recipe-card-title">${s.title}</h3>
            <p class="recipe-card-description">${s.description}</p>
            <div class="recipe-card-footer">
              <div class="recipe-card-rating">
                <span class="rating-value">${s.rating.toFixed(1)}</span>
                <div class="rating-stars" style="--rating: ${i}%">
                  <span>★★★★★</span>
                  <span class="stars-filled">★★★★★</span>
                </div>
              </div>
              <button class="recipe-card-button" type="button">See recipe</button>
            </div>
          </div>
        </div>`}).join("");y.innerHTML=`<div class="recipes-list">${r}</div>`,pe(V,e),v?y.classList.add("category-selected"):y.classList.remove("category-selected")}catch(t){console.error("An error occurred while loading recipes:",t),y.innerHTML="<p>The recipes could not be loaded. Please try again later.</p>",x.innerHTML=""}}function pe(e,t){let n="";for(let s=1;s<=e;s++)n+=`<button class="pagination-btn ${s===t?"active":""}" data-page="${s}">${s}</button>`;x.innerHTML=n,x.querySelectorAll(".pagination-btn").forEach(s=>{s.addEventListener("click",()=>{const i=Number(s.dataset.page);i!==g&&(g=i,S(g))})})}window.addEventListener("resize",()=>{N()!==A&&(g=1,S(g))});m&&m.classList.add("active");de();S();const T=document.querySelector(".popular-recipe-wrapper");console.log(Q());async function ue(){try{T.innerHTML="<p>Loading recipes...</p>";const e=await Q();if(!e||e.length===0){T.innerHTML="<p>No popular recipes found!</p>";return}const t=e.map(n=>`
    <div class="popular-recipes-card" data-id="${n._id}">
    <img class="popular-recipes-image" src="${n.preview}" alt="${n.title}" />
    <div class="popular-recipes-info">
    <h3 class="popular-recipes-title recipe-title">${n.title}</h3>
      <p class="popular-recipes-description popular-recipe-text ">${n.description}</p>
      </div>
    </div>
  `).join("");T.innerHTML=t}catch(e){console.error("Failed to fetch popular recipes:",e),T.innerHTML="<p>Sorry, we could not load the recipes at this time</p>"}}ue();const l=document.querySelector(".filters");l||console.warn("[filters] .filters bulunamadı.");const u=document.getElementById("pagination-filters")||document.getElementById("pagination"),c={search:l==null?void 0:l.querySelector(".filter-input"),searchBtn:l==null?void 0:l.querySelector(".search-btn"),resetBtn:l==null?void 0:l.querySelector(".reset-filter"),dropdowns:[...(l==null?void 0:l.querySelectorAll(".custom-dropdown"))??[]],recipes:document.getElementById("recipes-flex")},f={grid:document.getElementById("recipes-container"),pagination:document.getElementById("pagination")},F=!!c.recipes,o={query:"",time:"",area:"",ingredient:"",ingredientLabel:"",page:1,limit:6,loading:!1,lastItems:[],favs:new Set},Y="tt:favorites",ge=()=>{try{return new Set(JSON.parse(localStorage.getItem(Y)||"[]"))}catch{return new Set}},G=e=>{localStorage.setItem(Y,JSON.stringify([...e]))},X=e=>o.favs.has(e),fe=e=>{if(!e)return null;const t=o.favs.has(e);return t?o.favs.delete(e):o.favs.add(e),G(o.favs),!t};o.favs=ge();function ve(){const e=[...o.favs].filter(t=>t&&t!=="null"&&t!=="undefined");e.length!==o.favs.size&&(o.favs=new Set(e),G(o.favs))}function Z(e=document){e.querySelectorAll(".heart-btn").forEach(n=>{var i,a;const r=(a=(i=n.closest("[data-id]"))==null?void 0:i.dataset.id)==null?void 0:a.trim(),s=!!r&&X(r);n.classList.toggle("active",s)})}ve();const me=["10 min","20 min","30 min","40 min"];function J(e){o.loading=e,!(!F||!c.recipes)&&e&&(c.recipes.innerHTML='<div class="recipes-loading">Loading...</div>')}const we=1e4,ye=(e,t=we)=>Promise.race([e,new Promise((n,r)=>setTimeout(()=>r(new Error("REQUEST_TIMEOUT")),t))]);function he(e){const t=String(e).match(/\d+/);return t?t[0]:""}function I(e){c.dropdowns.forEach(t=>{t!==e&&t.classList.remove("open")})}function b(e){return String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;")}function P(){const e=window.innerWidth||1200;return e>=1024?9:e>=768?8:6}function be(){return!!(o.query||o.time||o.area||o.ingredient)}function Le(){f.grid&&(f.grid.style.display="none"),f.pagination&&(f.pagination.style.display="none"),c.recipes&&(c.recipes.style.display=""),u&&(u.style.display=""),document.dispatchEvent(new CustomEvent("filters:activate"))}function $e(){c.recipes&&(c.recipes.style.display="none"),u&&(u.style.display="none"),f.grid&&(f.grid.style.display=""),f.pagination&&(f.pagination.style.display=""),document.dispatchEvent(new CustomEvent("filters:deactivate"))}function ke(e,t){if(!u)return;e=Math.max(1,Number(e)||1),t=Math.min(e,Math.max(1,Number(t)||1));const n=1,r="pagination-btn arrow-btn arrow-prev",s="pagination-btn arrow-btn arrow-next";let i=`
    <button class="${r}" data-page="1" ${t===1?"disabled":""}>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="11 17 6 12 11 7"></polyline><polyline points="18 17 13 12 18 7"></polyline></svg>
    </button>
    <button class="${r}" data-page="${t-1}" ${t===1?"disabled":""}>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
    </button>
  `;if(e>1){t>n+2&&(i+='<button class="pagination-btn page-btn" data-page="1">1</button>',i+='<button class="pagination-btn dots" disabled>...</button>');for(let a=Math.max(1,t-n);a<=Math.min(e,t+n);a++)a===1&&t>n+2||a===e&&t<e-n-1||(i+=`<button class="pagination-btn page-btn ${a===t?"active":""}" data-page="${a}">${a}</button>`);t<e-n-1&&(i+='<button class="pagination-btn dots" disabled>...</button>',i+=`<button class="pagination-btn page-btn" data-page="${e}">${e}</button>`)}i+=`
    <button class="${s}" data-page="${t+1}" ${t===e?"disabled":""}>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
    </button>
    <button class="${s}" data-page="${e}" ${t===e?"disabled":""}>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="13 17 18 12 13 7"></polyline><polyline points="6 17 11 12 6 7"></polyline></svg>
    </button>
  `,u.innerHTML=e<=1?"":i}function ee(e){if(!c.recipes)return;const t=P(),n=Array.isArray(e)?e.slice(0,t):[];if(!n.length){c.recipes.innerHTML="";return}const r=n.map(s=>{const{_id:i,title:a="Untitled",description:d="",rating:p=0,preview:w,thumb:B}=s,M=w||B||"",O=b(a),U=b(d),D=Number(p)||0,re=Math.max(0,Math.min(100,D/5*100)),ae=X(i)?"active":"";return`
      <div class="recipe-card" data-id="${i||""}">
        <button class="heart-btn ${ae}" aria-label="Add to favorites">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22"
               viewBox="0 0 24 24" fill="none" stroke="currentColor"
               stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
        </button>

        ${M?`<img class="recipe-card-image" src="${M}" alt="${O}" loading="lazy">`:""}

        <div class="recipe-card-details">
          <h3 class="recipe-card-title">${O}</h3>
          ${U?`<p class="recipe-card-description">${U}</p>`:""}

          <div class="recipe-card-footer">
            <div class="recipe-card-rating">
              <span class="rating-value">${D.toFixed(1)}</span>
              <div class="rating-stars" style="--rating:${re}%">
                <span>★★★★★</span>
                <span class="stars-filled">★★★★★</span>
              </div>
            </div>
            <button class="recipe-card-button" type="button">See recipe</button>
          </div>
        </div>
      </div>`}).join("");c.recipes.innerHTML=r,Z(c.recipes)}async function k(){try{if(!be()){$e();return}Le(),J(!0);const e=P();o.limit=e;const{time:t,area:n,ingredient:r,page:s}=o,i=await ye(H({time:t,area:n,ingredient:r,page:s,limit:e})),a=Array.isArray(i==null?void 0:i.results)?i.results:Array.isArray(i)?i:Array.isArray(i==null?void 0:i.recipes)?i.recipes:[],d=o.query.toLowerCase(),p=d?a.filter(w=>String(w.title||"").toLowerCase().includes(d)):a;if(o.lastItems=p,F){if(ee(p.slice(0,e)),u){const w=Number(i==null?void 0:i.totalPages)||Number(i==null?void 0:i.pageCount)||0,B=Number(i==null?void 0:i.total)||Number(i==null?void 0:i.count)||Number(i==null?void 0:i.resultsCount)||Number(i==null?void 0:i.hits)||(Array.isArray(i==null?void 0:i.results)?i.results.length:0),M=w||Math.max(1,Math.ceil((B||p.length)/e));ke(M,o.page)}!p.length&&c.recipes&&(c.recipes.innerHTML='<p class="no-results">No recipes found</p>')}document.dispatchEvent(new CustomEvent("recipes:filtered",{detail:{recipes:p,paging:{page:s,limit:e},raw:i}}))}catch(e){console.error("[filters] applyFilters error:",(e==null?void 0:e.message)||e),F&&c.recipes&&(c.recipes.innerHTML=(e==null?void 0:e.message)==="REQUEST_TIMEOUT"?'<p class="no-results">İstek zaman aşımına uğradı. Lütfen tekrar deneyin.</p>':'<p class="no-results">Bir şeyler ters gitti. Lütfen tekrar deneyin.</p>'),document.dispatchEvent(new CustomEvent("recipes:filtered",{detail:{recipes:[],error:!0,reason:(e==null?void 0:e.message)||String(e)}}))}finally{J(!1)}}async function Ee(){h("time",me.map(e=>({value:he(e),label:e})));try{const e=await le(),t=(Array.isArray(e)?e:[]).map(n=>typeof n=="string"?n:n==null?void 0:n.name).filter(Boolean).map(n=>({value:n,label:n}));h("area",t)}catch(e){console.error("Areas yüklenemedi",e),h("area",[])}try{const e=await ce(),t=(Array.isArray(e)?e:[]).filter(n=>(n==null?void 0:n._id)&&(n==null?void 0:n.name)).map(n=>({value:n._id,label:n.name}));h("ingredient",t)}catch(e){console.error("Ingredients yüklenemedi",e),h("ingredient",[])}}function h(e,t){const n=c.dropdowns.find(i=>i.dataset.type===e);if(!n)return;const r=n.querySelector(".dropdown-menu"),s=n.querySelector(".dropdown-toggle");!r||!s||(r.innerHTML=(t||[]).map(i=>`<li><button type="button" data-value="${b(i.value)}" data-label="${b(i.label)}">${b(i.label)}</button></li>`).join(""),s.addEventListener("click",()=>{const i=!n.classList.contains("open");I(),n.classList.toggle("open",i)}),r.addEventListener("click",i=>{const a=i.target.closest("button[data-value]");if(!a)return;const d=a.getAttribute("data-value")??"",p=a.getAttribute("data-label")??a.textContent.trim();e==="time"?o.time=d:e==="area"?o.area=p:e==="ingredient"&&(o.ingredient=d,o.ingredientLabel=p),s.textContent=p,n.classList.remove("open"),o.page=1,k()}))}document.addEventListener("click",e=>{const t=e.target.closest(".custom-dropdown");if(!t)return I();c.dropdowns.forEach(n=>{n!==t&&n.classList.remove("open")})});document.addEventListener("keydown",e=>{e.key==="Escape"&&I()});function Se(){if(!c.search||!c.searchBtn)return;const e=()=>{o.query=c.search.value.trim(),o.page=1,k()};c.searchBtn.addEventListener("click",e),c.search.addEventListener("keydown",t=>{t.key==="Enter"&&(t.preventDefault(),e())})}const te={};(c.dropdowns||[]).forEach(e=>{const t=e.dataset.type,n=e.querySelector(".dropdown-toggle");t&&n&&(te[t]=n.getAttribute("data-default")||n.textContent.trim())});function Me(){c.resetBtn&&c.resetBtn.addEventListener("click",()=>{o.query="",o.time="",o.area="",o.ingredient="",o.ingredientLabel="",o.page=1,c.search&&(c.search.value=""),(c.dropdowns||[]).forEach(e=>{const t=e.dataset.type,n=e.querySelector(".dropdown-toggle"),r=e.querySelector(".dropdown-menu");n&&(n.textContent=te[t]||"Select"),r==null||r.querySelectorAll(".selected").forEach(s=>s.classList.remove("selected")),e.classList.remove("open")}),k()})}(async function(){var t;try{c.recipes&&(c.recipes.classList.add("recipes-list"),c.recipes.style.display="none"),u&&(u.style.display="none"),await Ee(),Se(),Me(),await k(),Z(),u&&u.addEventListener("click",n=>{const r=n.target.closest(".pagination-btn");if(!r||r.classList.contains("dots"))return;const s=parseInt(r.dataset.page,10);!isNaN(s)&&s!==o.page&&(o.page=s,k())}),document.addEventListener("click",n=>{var d;const r=n.target.closest(".heart-btn");if(!r)return;const s=r.closest("[data-id]"),i=(d=s==null?void 0:s.dataset.id)==null?void 0:d.trim();if(!i){console.warn("[favorites] data-id bulunamadı; işlem yapılmadı.");return}const a=fe(i);a!==null&&r.classList.toggle("active",a)}),(t=document.querySelector('.nav-link[href="./favorites.html"]'))==null||t.addEventListener("click",()=>{console.log("Favorites link clicked, redirecting...")}),document.addEventListener("click",n=>{const r=n.target.closest(".recipe-card-button");if(r){const s=r.closest(".recipe-card"),i=s==null?void 0:s.dataset.id;i&&console.log("Recipe clicked:",i)}}),window.addEventListener("resize",()=>{var n;(n=o.lastItems)!=null&&n.length&&ee(o.lastItems)})}catch(n){console.error("[filters] init error:",n),c.recipes&&(c.recipes.innerHTML='<p class="no-results">Bir şeyler ters gitti. Lütfen tekrar deneyin.</p>')}})();const ne="favoriteRecipes";function ie(){try{return JSON.parse(localStorage.getItem(ne))||[]}catch{return[]}}function W(e){localStorage.setItem(ne,JSON.stringify(e))}function Te(e){const t=ie();if(t.some(r=>r._id===e._id)){const r=t.filter(s=>s._id!==e._id);W(r)}else t.push(e),W(t)}function Ae(e){return ie().some(n=>n._id===e)}const _=document.querySelector("#recipes-container"),j=document.querySelector("#pagination");let L=[],$=1,K=1,C=z();function Ce(e){const t=e.rating/5*100,n=Ae(e._id)?"active":"";return`
    <div class="recipe-card" data-id="${e._id}">
      <button class="heart-btn ${n}" aria-label="Add to favorites">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
      </button>
      <img class="recipe-card-image" src="${e.thumb}" alt="${e.title}" loading="lazy">
      <div class="recipe-card-details">
        <h3 class="recipe-card-title">${e.title}</h3>
        <p class="recipe-card-description">${e.description}</p>
        <div class="recipe-card-footer">
          <div class="recipe-card-rating">
            <span class="rating-value">${e.rating.toFixed(1)}</span>
            <div class="rating-stars" style="--rating: ${t}%">
              <span>★★★★★</span><span class="stars-filled">★★★★★</span>
            </div>
          </div>
          <button class="recipe-card-button" type="button">See recipe</button>
        </div>
      </div>
    </div>`}function se(){if(!L||L.length===0)return;const e=L.map(Ce).join("");_.innerHTML=e}async function R(e=1){try{C=z();const t=await H({page:e,limit:C});L=t.results,K=t.totalPages||Math.ceil(t.totalResults/C),se(),xe(K,e)}catch(t){console.error("An error occurred while loading recipes:",t),_.innerHTML="<p>The recipes could not be loaded. Please try again later.</p>",j.innerHTML=""}}_.addEventListener("click",e=>{const t=e.target.closest(".heart-btn");if(!t)return;const r=t.closest(".recipe-card").dataset.id,s=L.find(i=>i._id===r);s&&(Te(s),se())});j.addEventListener("click",e=>{const t=e.target.closest(".pagination-btn");if(!t||t.disabled||!t.dataset.page)return;const n=Number(t.dataset.page);n!==$&&($=n,R($))});function xe(e,t){let n="";const s="pagination-btn arrow-btn arrow-prev",i="pagination-btn arrow-btn arrow-next";if(n+=`<button class="${s}" data-page="1" ${t===1?"disabled":""}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="11 17 6 12 11 7"></polyline><polyline points="18 17 13 12 18 7"></polyline></svg></button>`,n+=`<button class="${s}" data-page="${t-1}" ${t===1?"disabled":""}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button>`,e>1){t>3&&(n+='<button class="pagination-btn page-btn" data-page="1">1</button>',n+='<button class="pagination-btn dots">...</button>');for(let a=Math.max(1,t-1);a<=Math.min(e,t+1);a++)a===1&&t>3||a===e&&t<e-1-1||(n+=`<button class="pagination-btn page-btn ${a===t?"active":""}" data-page="${a}">${a}</button>`);t<e-1-1&&(n+='<button class="pagination-btn dots">...</button>',n+=`<button class="pagination-btn page-btn" data-page="${e}">${e}</button>`)}n+=`<button class="${i}" data-page="${t+1}" ${t===e?"disabled":""}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></button>`,n+=`<button class="${i}" data-page="${e}" ${t===e?"disabled":""}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="13 17 18 12 13 7"></polyline><polyline points="6 17 11 12 6 7"></polyline></svg></button>`,j.innerHTML=n}const Be=qe(()=>{z()!==C&&($=1,R($))});window.addEventListener("resize",Be);R();function qe(e,t=250){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>{e.apply(this,r)},t)}}function z(){const e=window.innerWidth;return e<768?6:e<1280?8:9}
//# sourceMappingURL=index.js.map
